# First Chapter

GitBook allows you to organize your book into chapters, 
each chapter is stored in a separate file like this one.

***
  这是对应用了惯性测量单元（IMU）的模型飞机以及直升机的基于方向
余弦矩阵（DCM）的理论与实现的系列文章的第一篇。事实上，这篇文章
到目前还只是一个草案，依然还有很多工作要做。许多评论者对于本篇文
章的增补和修改提出了很棒的建议，尤其是Louis LeGrand 和一些匿名
来信的人，我们应该制作并准备一些文章中还没有包含的图表。我们后面
会采纳他们的建议，但是这可能还需要花上很长一段时间。在此期间，我
们认为我们迄今得到的成果依旧能令很多读者受益。

  研究DCM的动机是将一个带有升降舵和方向舵控制的内在稳定的飞机在
稳定和控制功能上更进一步，使一个带有副翼和升降舵的特技飞机得到稳
定控制。本文的其中一个作者（Premerlan）几年前制作了一个两轴
板，并为一个温柔的淑女滑翔机制定了初步的固件来提供稳定性以及返航
功能。固件运行的已经足够好了，作者渐渐的信任返航功能了，但是这个
功能似乎总不像作者想要的那么好。尤其是下面两个问题始终找不到满意
的解决方案：	

* 混合控制。意识到当飞机倾斜转弯的时候，由倾斜角产生了两个问
题。第一，由于倾斜，飞机转弯时的偏航旋转对陀螺仪的偏航产生了一个
干扰信号。第二，为了完成一个水平的转动，升降舵需要需要一些向上的
偏量。偏转的大小取决于倾角的大小，这个不能直接测量得到。这两个问
题好比一个硬币的两面。

* 加速度：加速度计测量的是重力加速度与实际加速度相减所得到的差
值。加速度的值等于作用在飞机上总的气动力（升力，推力，阻力等）加
上重力 的和再除以飞机的质量最后计算所得到的结果。因此，加速度
测量的是作用在飞机上的总的空气动力的负值。重力的测量值是在使飞机
水平的过程中所需要的，但这不是在加速运动中从从加速度计中获取的
值。加速度是一个混杂变量。特别是当飞机上升或者下降的时候，在很
短的一段时间内，加速度计的输出没有改变，但是飞机实际上加速了。美
国国家航空和航天管理局的宇航员在教练机上也遇到过类似的情况。弹道
路径可以产生零净力，因此能够暂时地欺骗加速度计。将这个问题同前一
个结合起来可以防止小角度的俯仰控制，这个问题避免了我们在手动启动
飞机的时候使用俯仰自稳。

  意识到这个问题出现的部分原因是由于我们目前的飞控板不具有六个
自由度的惯性测量单元（IMU），因此决定重新设计一个新的，于是乎便
有了来自SparkFun的无人机开发板。

  凑巧的是我们的一个研究人员（Premerlani）决定去制作一个带副翼的
飞行器，但是发现自己就是掌握不好必要的飞行技能。一个夏天他就坠毁了5架飞机，其中有3次还必须将飞机整个替换掉。因此，为了更加稳定的飞行，他决定将新的电路板安装在他的Goldberg Endurance飞机上，如下图所示。
![plane](http://i.imgur.com/twFeQru.jpg)
  
  那么问题来了，怎么才能得到最好的效果？在我们的共同努力下，得到
了与Mahony[1]相同的结论。我们所需要的是一个“完全遵守旋转群非线性原理”的方法。我和Paul决定应该用一个方向余弦矩阵来表示旋转，我们可以用陀螺仪，加速度计以及GPS的信息来*保持*矩阵的元素，然后用来完成控制和导航。*在一个较高的水平*，这里是DCM的工作原理：


  1. 陀螺仪是飞行器方位信息的主要来源。非线性微分动力学方程  飞行器当前方位和   
  
  2. 意识到积分产生的数值误差会逐渐破坏DCM所必须满足的正交约束，我们对矩阵的元素做了一些常规的，小的调整使其重新满足约束。
  
  3. 意识到数值误差，陀螺仪漂移，以及陀螺仪补偿会逐渐累积DCM元素的误差，我们使用参考向量来检测这些误差，在检测到的误差和第1步中陀螺仪的输入之间加了一个PI负反馈调节器，这样可以使误差增加之前更快的将其消除。在此系统中，GPS用于检测偏航误差，加速度用于检测俯仰和横滚的误差。

该过程的示意图如图1所示。
![Figure 1](http://i.imgur.com/V48Y1B0.png)
              图1 DCM控制框图

 毫无疑问，你们应该都想知道什么是旋转群，为什么要*遵守*它。**你可能也想知道如何去使用DCM进行控制和导航。你可能也抱有跟匿名者看了Mahony的论文后相同的问题，所以我们将以这些问题开始：**

* 四元数是什么以及我们为什么用四元数而不是向量符号表示？
* 旋转群的含义是什么？
* 旋转矩阵是什么？
* 保持旋转矩阵的正交性有什么作用？
* 反对称矩阵是什么？
* 你能简要说明旋转矩阵的运动学原理吗？
* 你能简要说明旋转矩阵的动力学原理吗？

所有这一切都与旋转有关。从物理上来讲，我们要做的就是将飞机的方位表示成其相对于地球的旋转。有许多方法可以做到这一点。Mahony的论文讨论了两种不同的方法，旋转矩阵还有四元数。这两种表示方法的动机非常相似，它们都能够在不加近似值以及不产生奇点的情况下表示旋转。四元数的优势是其只需要四个变量就能表示一个旋转，而旋转矩阵需要9个。旋转矩阵的优势是它天生就是用来控制和导航的。我们选择旋转矩阵是因为它有着微弱的优势，而且其表示方法与人们习惯的方式相似。
![R matrix](http://i.imgur.com/lAHKdRR.png)

旋转矩阵描述的是一个坐标系相对于另一个坐标系的方位。旋转矩阵的列是一个坐标系的单位向量在另一个坐标系的中的投影。一个坐标系中的向量可以通过左乘一个旋转矩阵转移到另一个坐标系。相反的过程可以通过将一个向量做成这个旋转矩阵的逆矩阵实现，已证明旋转矩阵的逆矩阵与旋转矩阵的转置矩阵相等。（矩阵的转置就是将矩阵的行与列交换。）单位向量在控制和导航中非常有用，因为其模长固定等于1。因此通常将它们用来作点乘（·）和叉乘（×）以得到各个角的正弦值或者余弦值。
![transfer](http://i.imgur.com/SElkvQ6.png)
